## 微信聊天数据表设计

#### NO.1	--聊天主表

​	聊天主表的设计,这是最简单的,包含一个主键id,一个使用者id,还有一个对方id.

| 字段       | 描述       |
| ---------- | ---------- |
| id         | 主键       |
| user_id    | 使用者id   |
| another_id | 聊天对象id |



#### NO.2	--聊天列表

​	这张表是用来展示是否有未读消息,以及对方状态等



| 字段       | 描述         |
| ---------- | ------------ |
| id         | 主键,自增    |
| chat_id    | 聊天主表的id |
| user_id    | 用户的id     |
| another_id | 对方id       |
| is_online  | 是否在线     |
| unread     | 未读条数     |
| status     | 是否展示     |
|            |              |

#### NO.3	--详情表

这张表主要记录双方聊天的内容,时间等等

| 主键    | 描述               |
| ------- | ------------------ |
| id      | 主键自增           |
| chat_id | 主聊天id           |
| user_id | 消息拥有者的id     |
| content | 聊天内容           |
| time    | 发送时间           |
| type    | 消息类型           |
| is_last | 是否为最后一条信息 |

## 聊天步骤

1. ### 点击聊天

   ​	判断是否是第一次聊天,如果是则在主表生成一条记录并返	回主表id,在聊天列表插入两条记录

2. ### 进入聊天

   ​	获取上一次的聊天记录,并将对话状态改为在线

3. ### 发送信息

   ​	判断对方是否在线,不在线未读加1

   ​	将上一条最后一条信息改为否

   ​	向详情表插入这条信息,设为最后一条

4. ### 删除聊天列表

   ​	将该用户的聊天列表删除状态设为删除